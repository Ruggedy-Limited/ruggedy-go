<?php

namespace App\Transformers;

use App\Entities\Vulnerability;
use League\Fractal\TransformerAbstract;

class VulnerabilityTransformer extends TransformerAbstract
{
    /**
     * Transform a Vulnerability entity for the API
     *
     * @param Vulnerability $vulnerability
     * @return array
     */
    public function transform(Vulnerability $vulnerability)
    {
        return [
            'id'                 => $vulnerability->getId(),
            'name'               => $vulnerability->getName(),
            'description'        => $vulnerability->getDescription(),
            'severity'           => $vulnerability->getSeverity(),
            'pciSeverity'        => $vulnerability->getPciSeverity(),
            'isMalwareAvailable' => $vulnerability->getMalwareAvailable(),
            'malwareDescription' => $vulnerability->getMalwareDescription(),
            'impact'             => $vulnerability->getImpact(),
            'cvssScore'          => $vulnerability->getCvssScore(),
            'resolution'         => $vulnerability->getSolution(),
            'genericOutput'      => $vulnerability->getGenericOutput(),
            'attackType'         => $vulnerability->getAttackType(),
            'createdDate'        => $vulnerability->getCreatedAt(),
            'modifiedDate'       => $vulnerability->getUpdatedAt(),
        ];
    }
}